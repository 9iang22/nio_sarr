{"id": "alias-path-traversal", "rule": "rules:\n- fix-regex:\n    regex: location\\s+([A-Za-z0-9/-_\\.]+)\n    replacement: location \\1/\n  id: alias-path-traversal\n  languages:\n  - generic\n  message: The alias in this location block is vulnerable to path traversal due to\n    the absence of a path separator (e.g., '/') at the end of the location path. Add\n    a path separator to resolve this issue.\n  patterns:\n  - pattern: \"location ... {\\n  ...\\n  alias .../;\\n  ...\\n}\\n\"\n  - pattern-not-inside: location /.../ { ... ... }\n  severity: WARNING\n", "failed_tests": "  \n    # ok: alias-path-traversal\n    location /fm/ {\n      alias /usr/local/web/fm/dist/;\n      index index.php;\n  \n      location ~ /([^/]+\\.php)$ {\n        try_files     /$1 =404;\n        include       fastcgi_params;\n      }\n    }\n\n", "failed_type": "fp", "testsuite_a": "server {\n  listen 80;\n\n  # ruleid: alias-path-traversal\n  location /i {\n    alias /data/w3/images/;\n  }\n\n  # ok: alias-path-traversal\n  location /i/ {\n    alias /data/w3/images/;\n  }\n\n  # ok: alias-path-traversal\n  location /i {\n    alias /data/w3/images;\n  }\n}\n", "testsuite_b": "server {\n  listen 80;\n\n  # ruleid: alias-path-traversal\n  location /i {\n    alias /data/w3/images/;\n  }\n\n  # ok: alias-path-traversal\n  location /i/ {\n    alias /data/w3/images/;\n  }\n\n  # ok: alias-path-traversal\n  location /i {\n    alias /data/w3/images;\n  }\n\n  # ok: alias-path-traversal\n  location /fm/ {\n    alias /usr/local/web/fm/dist/;\n    index index.php;\n\n    location ~ /([^/]+\\.php)$ {\n      try_files     /$1 =404;\n      include       fastcgi_params;\n    }\n  }\n}\n", "ground_truth": "rules:\n- id: alias-path-traversal\n  patterns:\n     - pattern: |\n          location $...LOCATION {\n            ...\n            alias .../;\n            ...\n          }\n     - metavariable-pattern:\n        metavariable: $...LOCATION\n        pattern-regex: ^.*[^/]$\n  paths:\n    include:\n    - '*.conf'\n    - '*.vhost'\n    - sites-available/*\n    - sites-enabled/*\n  fix-regex:\n    regex: location\\s+([A-Za-z0-9/-_\\.]+)\n    replacement: location \\1/\n  languages:\n  - generic\n  severity: WARNING\n  message: >-\n    The alias in this location block is subject to a path traversal\n    because the location path does not end in a path separator (e.g., '/').\n    To fix, add a path separator to the end of the path.\n  metadata:\n    cwe:\n    - \"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"\n    source-rule-url: https://github.com/yandex/gixy/blob/master/docs/en/plugins/aliastraversal.md\n    category: security\n    technology:\n    - nginx\n    confidence: LOW\n    owasp:\n    - A05:2017 - Broken Access Control\n    - A01:2021 - Broken Access Control\n    references:\n    - https://owasp.org/Top10/A01_2021-Broken_Access_Control\n    - https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/\n    - https://www.youtube.com/watch?v=CIhHpkybYsY\n    - https://github.com/orangetw/My-Presentation-Slides/blob/main/data/2018-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out.pdf\n    cwe2022-top25: true\n    cwe2021-top25: true\n    subcategory:\n    - audit\n    likelihood: LOW\n    impact: LOW\n", "rule_path": "extend_dataset/bafd13e1/before/alias-path-traversal.yaml", "test_path": "extend_dataset/bafd13e1/after/alias-path-traversal.conf", "category": "historical", "splited_testsuite_b": ["server {\n  listen 80;\n\n  # ruleid: alias-path-traversal\n  location /i {\n    alias /data/w3/images/;\n  }\n}", "server {\n  listen 80;\n\n  # ok: alias-path-traversal\n  location /i/ {\n    alias /data/w3/images/;\n  }\n}", "server {\n  listen 80;\n\n  # ok: alias-path-traversal\n  location /i {\n    alias /data/w3/images;\n  }\n}", "server {\n  listen 80;\n\n  # ok: alias-path-traversal\n  location /fm/ {\n    alias /usr/local/web/fm/dist/;\n    index index.php;\n\n    location ~ /([^/]+\\.php)$ {\n      try_files     /$1 =404;\n      include       fastcgi_params;\n    }\n  }\n}"]}
